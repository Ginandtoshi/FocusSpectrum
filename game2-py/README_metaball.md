# 彩虹元球动态焦点区域游戏 (Rainbow Metaball Dynamic Focus Game)

## 🌈 游戏简介

这是一个具有**流动彩虹边界**的动态焦点区域游戏！使用元球算法创建不断变化的有机形状边界，结合手指追踪技术，提供独特的视觉体验和挑战性的控制任务。

## ✨ 核心特性

### 🎨 **动态彩虹元球效果**
- **流动边界**：焦点区域边界持续流动变化
- **彩虹色彩**：HSV色彩空间生成的流动彩虹效果
- **有机形状**：基于元球算法的自然流动形状
- **实时变化**：位置和形状都在实时变化

### 🎯 **游戏机制**
- **动态挑战**：焦点区域不断变化，增加难度
- **精准控制**：需要手指精确控制保持小球在边界内
- **时间压力**：45秒倒计时增加紧张感
- **得分系统**：小球在彩虹区域内的时间累计得分

## 🔬 **技术实现**

### 🌟 **元球算法 (Metaball Algorithm)**
```python
# 元球值计算公式
v = Σ(r²/(dx² + dy²))

# 边界检测
0.85 < v < 1.15  # 彩虹边界范围
v >= 0.85        # 焦点区域范围
```

### 🎨 **彩虹色彩生成**
```python
def hsv_to_rgb(h, s, v):
    # HSV → RGB 转换
    # h: 色相 (随时间和元球值变化)
    # s: 饱和度 (1.0 = 完全饱和)
    # v: 明度 (1.0 = 最亮)
```

### 🔄 **动态更新机制**
- **位置更新**：每帧更新元球位置
- **碰撞反弹**：边界碰撞时反向移动
- **颜色流动**：色相随时间连续变化
- **性能优化**：降采样渲染提高帧率

## 🎮 **操作指南**

### ⌨️ **控制方式**
- **手指控制**：食指指向屏幕控制小球移动
- **C 键**：开始9点校准序列
- **空格键**：开始/重新开始45秒游戏
- **R 键**：紧急重置小球到屏幕中心

### 🎯 **游戏目标**
1. 保持亮黄色小球在流动的彩虹边界内
2. 适应不断变化的焦点区域形状
3. 在45秒内获得尽可能高的分数
4. 挑战手指控制的精准度和适应性

### 📐 **校准步骤**
1. 按 **C** 键开始校准
2. 依次用食指指向9个校准点
3. 每点持续4秒进行数据收集
4. 完成后即可开始游戏

## 🎨 **视觉效果**

### 🌈 **彩虹元球边界**
- **流动形状**：有机、连续变化的边界
- **色彩渐变**：从红→橙→黄→绿→蓝→紫的连续变化
- **时间驱动**：色彩随时间缓慢流动
- **深色背景**：突出彩虹效果的视觉对比

### 💫 **小球设计**
- **亮黄色**：在彩虹背景下清晰可见
- **白色边框**：增强视觉识别度
- **流畅运动**：多帧平滑算法确保移动流畅

## ⚡ **性能优化**

### 🔧 **渲染优化**
- **降采样**：每8像素采样一次元球值
- **缓存机制**：边界点缓存减少重复计算
- **更新间隔**：50ms更新间隔平衡效果和性能
- **智能边界**：只计算边界附近的点

### 📊 **算法效率**
- **元球数量**：6个元球平衡效果和性能
- **速度控制**：较慢的移动速度确保视觉流畅
- **碰撞检测**：简化的边界反弹算法

## 🌟 **与原版p5.js的对应关系**

| p5.js概念 | Python实现 | 说明 |
|-----------|------------|------|
| `Shader` | `MetaballRenderer` | 元球渲染和效果生成 |
| `metaballs[]` | `self.metaballs` | 元球数组 |
| `hsv2rgb()` | `hsv_to_rgb()` | HSV到RGB转换 |
| `uniform` | 直接计算 | 实时元球值计算 |
| `gl_FragColor` | `pygame.draw.circle()` | 像素点绘制 |

## 🚀 **运行要求**

- **Python 3.7+**
- **摄像头** (手指检测)
- **依赖库**:
  ```bash
  pip install pygame opencv-python mediapipe numpy
  ```

## 🎭 **游戏模式**

- **练习模式**：自由控制，熟悉流动边界
- **挑战模式**：45秒计时，追求高分
- **观赏模式**：欣赏流动的彩虹元球效果

---

**独特之处**：这是首个将元球算法与手指追踪结合的交互式游戏，提供前所未有的动态视觉体验和控制挑战！