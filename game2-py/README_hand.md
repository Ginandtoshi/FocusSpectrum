# 手指控制游戏 (Hand Tracking Game)

## 🎮 游戏简介

这是一个使用手指追踪技术控制小球移动的专注度测试游戏。游戏使用MediaPipe进行实时手部检测，通过食指位置控制屏幕上的发光小球。

## ✋ 控制方式

- **手指控制**：使用食指指向屏幕来控制小球移动
- **不需要鼠标**：完全通过手指手势进行控制
- **精准映射**：手指移动与小球移动保持线性对应关系

## 🎯 游戏目标

- 在45秒内保持发光小球在屏幕中心的焦点区域内
- 测试手指控制的精准度和专注度
- 小球在焦点区域内的时间越长，得分越高

## 🔧 系统要求

- Python 3.7+
- 摄像头（用于手部检测）
- macOS/Windows/Linux

## 📦 安装依赖

```bash
pip install -r requirements.txt
```

依赖库：
- `pygame>=2.0.0` - 游戏引擎
- `opencv-python>=4.5.0` - 计算机视觉
- `mediapipe>=0.10.0` - 手部检测

## 🚀 运行游戏

```bash
python main_hand.py
```

## ⌨️ 操作指南

### 🎮 基本控制
- **C 键**：开始9点校准序列
- **空格键**：开始/重新开始45秒游戏
- **R 键**：紧急重置小球到屏幕中心
- **ESC/关闭窗口**：退出游戏

### 📐 校准步骤
1. 按 **C** 键开始校准
2. 依次将食指指向屏幕上出现的白色圆圈
3. 每个校准点持续4秒钟
4. 完成9个校准点后系统自动生成映射关系

### ✋ 手指追踪要求
- 保持手在摄像头视野内
- 使用食指进行指向
- 避免快速移动以确保稳定追踪
- 良好的光线条件有助于提高检测精度

## 🎨 游戏界面

- **发光小球**：绿色实心圆，跟随手指移动
- **焦点区域**：灰色线框圆圈，保持小球在内得分
- **实时信息**：显示剩余时间、得分、手指检测状态
- **校准状态**：显示是否已完成校准

## 🔧 技术特性

### 📍 精准映射算法
- **线性响应**：手指小幅移动对应小球小幅移动
- **死区保护**：忽略8像素以内的微小抖动
- **动态响应**：根据移动距离调整响应强度
- **边界保护**：防止小球移出屏幕边界

### 🎯 手指检测
- **MediaPipe驱动**：使用Google MediaPipe进行手部关键点检测
- **食指追踪**：专门追踪食指尖端位置 (landmark 8)
- **多帧平滑**：使用最近3帧数据进行位置平滑
- **单手模式**：只检测一只手，提高稳定性

### 📊 校准系统
- **9点校准**：覆盖屏幕中心、四角、四边中点
- **仿射变换**：将手指坐标映射到屏幕坐标
- **数据收集**：每点收集4秒数据确保精度

## 🐛 故障排除

### 手指检测问题
- 确保摄像头正常工作
- 检查光线条件是否良好
- 尝试调整手到摄像头的距离
- 确保手指在摄像头视野内

### 校准失败
- 重新按 C 键开始校准
- 确保在校准点持续指向4秒
- 避免在校准过程中移动手指
- 检查HUD显示的手指检测状态

### 小球响应异常
- 按 R 键重置小球位置
- 重新进行校准
- 检查是否有其他物体干扰检测

## 🎮 游戏模式

- **练习模式**：校准完成后自由练习手指控制
- **计时模式**：45秒专注度测试，尽可能保持小球在焦点区域
- **紧急重置**：任何时候都可以按 R 键重置

## 📈 性能优化

- 游戏运行在60 FPS
- 手指检测运行在30 FPS以节省计算资源
- 智能边界检查防止小球消失
- 多级平滑算法确保流畅控制

---

**注意**：首次使用需要进行校准，校准质量直接影响控制精度。建议在稳定的光线环境下进行校准。